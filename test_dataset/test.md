Retrosnake has been tested with publicly available data. The process is documented here.

# Collecting the data

The FASTQ secuencing is available at `ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/hgsv_sv_discovery/working/20181210_ONT_rebasecalled/`.
To download them, `cd` to the directory in which you want store them (the one you would as input directory for Retrosnake):

```
wget -c ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/hgsv_sv_discovery/working/20181210_ONT_rebasecalled/*
```

Now, to convert the tar balls (`.tar.gz`) into FASTQ:

```
tar -zxf HG00514.ONT.rebasecalled.fastq.tar.gz --wildcards '*.fastq*' -O 2>/dev/null | gzip > HG00514.fastq.gz
tar -zxf HG00733.ONT.rebasecalled.fastq.tar.gz --wildcards '*.fastq*' -O 2>/dev/null | gzip > HG00733.fastq.gz
tar -zxf NA19240.ONT.rebasecalled.fastq.tar.gz --wildcards '*.fastq*' -O 2>/dev/null | gzip > NA19240.fastq.gz
```

# Configuration

Now, edit the `config.test.yaml` to edit the path to the directory with the files and the output path:

```
fastq_directory: "/path/to/input/dir"
outputPath: "/path/to/output/dir" # Don't include the trailing "/"
```

You may want to edit the number of threads to use, too. The default in this configuration file is 16.

# Execution

Everything is set up to execute the pipeline. Note that it will take several hours, so consider using nohup (or if you are on cluster, scheduling it through SLURM).

```
cd </your/path/to/retrosnake>
mamba activate snakemake
snakemake --use-conda --configfile test_dataset/config.test.yaml -c <threads>
```

Before running the actual command, you may want to see the list of tasks that will be run:

```
# if not in your snakemake env, run
# mamba activate snakemake
snakemake -np --use-conda --configfile test_dataset/config.test.yaml -c <threads>
```

You may also want to see the graph of rules that will be executed:

```
# if not in your snakemake env, run
# mamba activate snakemake
snakemake -n --use-conda --configfile test_dataset/config.test.yaml -c 1 --dag | dot -T svg > test_data_dag.svg
```

# Notes

If you use Retrosnake, refer to the main README of this repository for the citation.

The data used for this example has not been generated by us. Please cite [Chaisson et al. 2019 Nature Communications](https://www.nature.com/articles/s41467-018-08148-z) if you use the data on your research.

See ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/hgsv_sv_discovery/README_hgsvc_datareuse_statement.md for more information on reuse of these datasets.
